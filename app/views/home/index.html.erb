<% content_for :title, "Dashboard" %>

<div class="container mx-auto py-10">
  <!-- Stats Cards -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <!-- Total Students -->
    <div class="bg-white shadow-[0px_4px_15px_rgba(0,0,0,0.2),0px_-4px_15px_rgba(0,0,0,0.2)] rounded-xl p-6 text-center">
      <i class="fa-solid fa-user-graduate text-blue-600 text-5xl mb-2"></i>
      <h3 class="text-lg font-semibold text-gray-600">Total Students</h3>
      <p class="text-4xl font-bold"><%= number_with_delimiter(@total_students) %></p>
      <p class="text-gray-500">Active Students: <%= @active_students %> | Inactive: <%= @inactive_students %></p>
    </div>

    <!-- Attendance Count -->
    <div class="bg-white shadow-[0px_4px_15px_rgba(0,0,0,0.2),0px_-4px_15px_rgba(0,0,0,0.2)] rounded-xl p-6 text-center">
      <i class="fa-solid fa-user-check text-green-500 text-5xl mb-2"></i>
      <h3 class="text-lg font-semibold text-gray-600">Total Check-Ins</h3>
      <p class="text-4xl font-bold"><%= number_with_delimiter(@attendance_count) %></p>
      <p class="text-gray-500">Last Check-in: <%= @last_checkin.nil? ? 'N/A' : time_ago_in_words(@last_checkin) %> ago</p>
    </div>

    <!-- Attendance Rate -->
    <div class="bg-white shadow-[0px_4px_15px_rgba(0,0,0,0.2),0px_-4px_15px_rgba(0,0,0,0.2)] rounded-xl p-6 text-center">
      <i class="fa-solid fa-chart-line text-purple-500 text-5xl mb-2"></i>
      <h3 class="text-lg font-semibold text-gray-600">Attendance Rate</h3>
      <p class="text-4xl font-bold"><%= @attendance_rate %>%</p>
      <p class="text-gray-500">Based on active students</p>
    </div>
  </div>

  <!-- Recent Check-ins -->
  <div class="mt-10">
    <h2 class="text-2xl font-semibold mb-4">Recent Check-Ins</h2>
    <table class="table-auto w-full border-collapse border border-gray-200">
      <thead>
      <tr class="bg-gray-100">
        <th class="border p-2">Student</th>
        <th class="border p-2">Classroom</th>
        <th class="border p-2">Check-in Time</th>
      </tr>
      </thead>
      <tbody>
      <% @recent_checkins.each do |checkin| %>
        <tr>
          <td class="border p-2"><%= checkin.student.name %></td>
          <td class="border p-2"><%= checkin.student.classroom.class_id %></td>
          <td class="border p-2"><%= time_ago_in_words(checkin.timestamp) %> ago</td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>
</div>
